zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,5,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,5,TRUE,FALSE)
Theta<-matrix(res$Theta[5,],ncol=community,nrow=1000)
View(Theta)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,5,TRUE,FALSE)
Theta<-matrix(res$Theta[5,],ncol=community,nrow=1000)
View(Theta)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,5,TRUE,FALSE)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
View(dat)
colSums(dat)
rowSums(dat)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
test<-generateZBinomial(dat,pop, Theta, Phi)
test<-generateZBinomial(dat,pop, Theta, Omega)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
View(dat)
4+1+12+1+2
1+36+1+2
View(dat)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
test<-generateZBinomial(dat,pop, Theta, Omega)
lenght(test)
length(test)
i<-1
z<-test[[i]]
z
1+2+3+3+1+3+1+4+2
i<-2
z<-test[[i]]
z
library(Rlda)
library(Rlda)
#Clean ethe Working Directory
rm(list=ls())
set.seed(17)
library(gtools)
library(Rlda)
#Working directory
#source("C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\gibbs functions.R")
dat=data.matrix(read.csv('C:\\Users\\p.albuquerque\\Dropbox\\Rlda\\tests\\Binomial Denis\\fake data.csv',as.is=T)[,-1])
#Number of communities
community <- 10
#Number of bands
bands<-ncol(dat)
#Number of locations
locations<-nrow(dat)
#priors
a1=1; a2=1
gamma=1
#initial values
Theta=matrix(1/community,locations,community)
Omega=matrix(runif(community*bands),bands,community)
#assign everybody to community 1
max.dat=max(dat)
zmat=expand.grid(comm=1,bands=1:bands,reflect=0:1,loc=1:locations,n=NA)
for (i in 1:bands){
cond=zmat$bands==i & zmat$reflect==1
zmat[cond,'n']=dat[,i]
cond=zmat$bands==i & zmat$reflect==0
zmat[cond,'n']=max.dat-dat[,i]
}
pop<-matrix(40,nrow=nrow(dat),ncol=ncol(dat))
res<- lda_binomial(dat,pop,community,a1,a2,gamma,1,TRUE,FALSE)
res<- lda_binomial(dat,pop,community,a1,a2,gamma,100,TRUE,FALSE)
Theta<-matrix(res$Theta[100,],ncol=community,nrow=1000)
View(Theta)
